SHARE/soc_method_gradient.cpp